motif <- read.csv('/home/nikita/Documents/work/git_projects/GenomeAssembly/first/TTTOI_df.tsv', sep = '\t')
motif
motif <- read.csv('/home/nikita/Documents/work/git_projects/GenomeAssembly/first/TTTOI_df.tsv', sep = '\t', header = T)
motif
motif['alphabet'] <- c('S','T','O','B','I','N')
motif
ggplot(motif, aes(x=alphabet)) + geom_bar()
ggplot(motif, aes(x=alphabet, y=X0)) + geom_bar()
ggplot(motif, aes(x=alphabet, y=X0)) + geom_errorbar()
ggplot(motif, aes(x=alphabet, y=X0)) + geom_boxplot()
ggplot(motif, aes(x=alphabet)) + geom_boxplot()
ggplot(motif, aes(x=alphabet, y=X0)) + geom_boxplot()
table(motif)
motif
table(motif)
motif['alphabet'] <- c('S','T','O','B','I','N')
motif
barplot(motif)
barplot(motif$X0)
matrix(motif)
motif <- read.csv('/home/nikita/Documents/work/git_projects/GenomeAssembly/first/TTTOI_df.tsv', sep = '\t', header = T)
matrix(motif)
motif
data.matrix(motif)
barplot(matrix_motifs, col = c("brown", "chocolate", "yellow", "red"))
matrix_motifs <- data.matrix(motif)
barplot(matrix_motifs, col = c("brown", "chocolate", "yellow", "red"))
barplot(matrix_motifs, col = c("brown", "chocolate", "yellow", "red", "blue", "green"))
library(ggplot2)
motif <- read.csv('/home/nikita/Documents/work/git_projects/GenomeAssembly/first/TTTOI_df.tsv', sep = '\t', header = T)
colnames(motif) <- c("first", "second", "penultimate", "last")
matrix_motifs <- data.matrix(motif)
barplot(matrix_motifs, col = c("brown", "chocolate", "yellow", "red", "blue", "green"))
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "
X0  X1 X.2 X.1
S 78  78  86  92
T 58  70  62  66
O 88 101  95  83
B 71  64  54  59
I 68  68  74  78
N 88  70  80  73",sep = "",header = TRUE)
dat <- read.table(text = "
X0  X1 X.2 X.1
1  78  78  86  92
2  58  70  62  66
3  88 101  95  83
4  71  64  54  59
5  68  68  74  78
6  88  70  80  73",sep = "",header = TRUE)
dat <- read.table(text = "    ONE TWO PENULTIMATE LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "",header = TRUE)
# Add an id variable for the filled regions and reshape
datm <- dat %>%
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number()) %>% gather(variable, value, -ind)
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
# or:
# geom_bar(position = position_fill(), stat = "identity")
scale_y_continuous(labels = scales::percent_format())
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number()) %>% gather(variable, value, -ind))
dat <- read.table(text = "    ONE TWO PENULTIMATE LA
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "",header = TRUE)
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number()) %>% gather(variable, value, -ind))
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    ONE TWO PENULTIMATE LA
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "",header = TRUE)
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number()) %>% gather(variable, value, -ind))
dat
str(dat)
ggplot(dat, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
# or:
# geom_bar(position = position_fill(), stat = "identity")
scale_y_continuous(labels = scales::percent_format())
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number()))
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
# or:
# geom_bar(position = position_fill(), stat = "identity")
scale_y_continuous(labels = scales::percent_format())
dat <- read.table(text = "    ONE TWO PENULTIMATE LA
S   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
str(dat)
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
# or:
# geom_bar(position = position_fill(), stat = "identity")
scale_y_continuous(labels = scales::percent_format())
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -later)
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
# or:
# geom_bar(position = position_fill(), stat = "identity")
scale_y_continuous(labels = scales::percent_format())
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = count), position = position_fill(vjust = 0.5))
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(lab = count), position = position_fill(vjust = 0.5))
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = variable), position = position_fill(vjust = 0.5))
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = value), position = position_fill(vjust = 0.5))
total = sum(dat$ONE)
total
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = value/total), position = position_fill(vjust = 0.5))
geom_text(aes(label = round(value/total, 3), position = position_fill(vjust = 0.5))
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5))
datm
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
datm[datm$ind == 1] <- "S"
datm[datm$ind == 1]
datm[datm$ind]
datm$ind
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    ONE TWO PENULTIMATE LA
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5))
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procrntage")
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
dat <- read.table(text = "    ONE TWO PENULTIMATE LA
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
dat <- read.table(text = "    ONE TWO PENULTIMATE LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    ONE TWO PENULTIMATE LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    ONE TWO PENULTIMATE LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
dat <- read.table(text = "    1.ONE 2.TWO 3.PENULTIMATE 4.LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
dat <- read.table(text = "    1_ONE 2_TWO 3_PENULTIMATE 4_LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    1_ONE 2_TWO 3_PENULTIMATE 4_LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    1.ONE 2.TWO 3.PENULTIMATE 4.LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    ONE TWO PENULTIMATE LAST
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    1 2 -2 -1
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$ONE)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos:1 pos:2 pos:-2 pos:-1
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos:1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos.1 pos.2 pos.-2 pos.-1
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos.1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos.1 pos.2 pos.penultim pos.last
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos.1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos.1 pos.2 pos.penultim pos.final
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos.1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos.1 pos.2 pos.penultim pos.end
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos.1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
library(ggplot2)
library(dplyr)
library(tidyr)
dat <- read.table(text = "    pos.1 pos.2 pos.pre-ultim pos.ultim
1   78  78  86  92
2   58  70  62  66
3   88 101  95  83
4   71  64  54  59
5   68  68  74  78
6   88  70  80  73",sep = "", header = TRUE)
total = sum(dat$pos.1)
total
# Add an id variable for the filled regions and reshape
datm <- dat %>% mutate(ind = factor(row_number())) %>% gather(variable, value, -ind)
levels(datm$ind) <- c('S','T','O','B','I','N')
ggplot(datm, aes(x = variable, y = value, fill = ind)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent_format()) +
geom_text(aes(label = round(value/total, 3)), position = position_fill(vjust = 0.5)) +
xlab("position in motif") +
ylab("Procentage")
